<ServerManagerConfiguration>

  <!-- Begin Mini Slam -->
  <ProxyGroup name="filters">
    <SourceProxy name="MiniSLAM"
                 class="vtkMiniSlam"
                 label="Mini SLAM"
                 base_proxygroup="filters"
                 base_proxyname="SlamOnline">

      <Documentation
        short_help="Applies SLAM on input LiDAR frames and displays the most recently transformed frames."
        long_help="Applies SLAM on input LiDAR frames and displays the most recently transformed frames.">
        The Mini SLAM filter is a real-time application of SLAM algorithms to sequential LiDAR frames.
        The output of the filter is the most recently transformed frames. The filter heritages from vtkSlam filter.
        It is ideal for applications requiring visualization of the latest SLAM-processed frames
        for quick inspection.
      </Documentation>

      <!-- ================ Mini Slam Parameters ================ -->

      <IntVectorProperty name="Number of SLAM frames"
                         command="SetNumberOfSlamFrames"
                         number_of_elements="1"
                         default_values="5">
        <Documentation>
         The number of slam frames displayed at the same time.
        </Documentation>
      </IntVectorProperty>

      <IntVectorProperty name="Display at origin"
                         command="SetDisplayAtOrigin"
                         default_values="1"
                         number_of_elements="1">
        <BooleanDomain name="bool" />
        <Documentation>
         If enabled use the optional trajectory input to place trailing frame in LiDAR referential
         by compensating trajectory.
        </Documentation>
      </IntVectorProperty>

      <IntVectorProperty name="Reference frame"
                         command="SetRefFrame"
                         number_of_elements="1"
                         default_values="0">
        <EnumerationDomain name="enum">
          <Entry value="0" text="Newest Frame" />
          <Entry value="1" text="Oldest Frame" />
        </EnumerationDomain>
        <Documentation>
          Define the referential trailing frame used to compensate origin, can be either first or last.
        </Documentation>
        <Hints>
          <PropertyWidgetDecorator type="GenericDecorator" mode="visibility" property="Display at origin" value="1" />
        </Hints>
      </IntVectorProperty>

      <PropertyGroup label="Mini SLAM manager parameters">
        <Property name="Number of SLAM frames" />
        <Property name="Display at origin" />
        <Property name="Reference frame" />
      </PropertyGroup>

      <!-- ============= Override slam filter's parameters ============ -->

      <!--~~~~~~~~~~~~~~~~~~~~~~~~~ Inputs options ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
      <Property name="Reset state"
                override="1"
                command="ResetMiniSlam">
        <Documentation>
          Reset mini SLAM internal state: maps and trajectory are cleared,
          current pose is set back to origin.
          This keeps parameters unchanged.
        </Documentation>
      </Property>

      <StringVectorProperty name="Reload trajectory"
                            override="1"
                            panel_visibility="never">
      </StringVectorProperty>

      <!--~~~~~~~~~~~~~~~~~~~~~~~~~ Inputs options ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
      <StringVectorProperty name="External sensors data file"
                            override="1"
                            panel_visibility="never">
      </StringVectorProperty>

      <IntVectorProperty name="Auto detect input arrays"
                         override="1"
                         command="SetAutoDetectInputArrays"
                         number_of_elements="1"
                         default_values="1">
        <BooleanDomain name="bool" />
        <Documentation>
          If enabled, SLAM filter will try to auto-detect the time, intensity
          and laser ring id arrays to use depending on LiDAR model.
        </Documentation>
      </IntVectorProperty>

      <!-- If auto-detection mode is disabled, user needs to specify input arrays to use -->
      <StringVectorProperty name="Time array"
                            override="1"
                            command="SetInputArrayToProcess"
                            number_of_elements="5"
                            element_types="0 0 0 0 2"
                            default_values_delimiter=";"
                            default_values="0;0;0;0;timestamp">
        <ArrayListDomain attribute_type="Scalars" name="array_list">
          <RequiredProperties>
            <Property function="Input" name="Input" />
          </RequiredProperties>
        </ArrayListDomain>
        <Documentation>
          The points measurements timestamps.
        </Documentation>
        <Hints>
          <PropertyWidgetDecorator type="GenericDecorator" mode="visibility" property="Auto detect input arrays" value="0" />
        </Hints>
      </StringVectorProperty>

      <StringVectorProperty name="Intensity array"
                            override="1"
                            command="SetInputArrayToProcess"
                            number_of_elements="5"
                            element_types="0 0 0 0 2"
                            default_values_delimiter=";"
                            default_values="1;0;0;0;intensity">
        <ArrayListDomain attribute_type="Scalars" name="array_list">
          <RequiredProperties>
            <Property function="Input" name="Input" />
          </RequiredProperties>
        </ArrayListDomain>
        <Documentation>
          The points intensity/reflectivity measurements.
        </Documentation>
        <Hints>
          <PropertyWidgetDecorator type="GenericDecorator" mode="visibility" property="Auto detect input arrays" value="0" />
        </Hints>
      </StringVectorProperty>

      <StringVectorProperty name="Laser ring id array"
                            override="1"
                            command="SetInputArrayToProcess"
                            number_of_elements="5"
                            element_types="0 0 0 0 2"
                            default_values_delimiter=";"
                            default_values="2;0;0;0;laser_id">
        <ArrayListDomain attribute_type="Scalars" name="array_list">
          <RequiredProperties>
            <Property function="Input" name="Input" />
          </RequiredProperties>
        </ArrayListDomain>
        <Documentation>
          The laser ring ids that acquired points.
        </Documentation>
        <Hints>
          <PropertyWidgetDecorator type="GenericDecorator" mode="visibility" property="Auto detect input arrays" value="0" />
        </Hints>
      </StringVectorProperty>

      <!--~~~~~~~~~~~~~~~~~~~~~~~~~ Outputs options ~~~~~~~~~~~~~~~~~~~~~~~~~-->

      <IntVectorProperty name="Advanced return mode"
                         override="1"
                         command="SetAdvancedReturnMode"
                         default_values="0"
                         panel_visibility="never">
        <BooleanDomain name="bool" />
      </IntVectorProperty>

      <IntVectorProperty name="Failure detection"
                         override="1"
                         command="SetFailureDetectionEnabled"
                         default_values="0"
                         panel_visibility="never">
        <BooleanDomain name="bool" />
      </IntVectorProperty>

      <IntVectorProperty name="Keypoint maps output mode"
                         override="1"
                         command="SetOutputKeypointsMaps"
                         default_values="0"
                         panel_visibility="never">
        <EnumerationDomain name="enum">
          <Entry value="0" text="Disabled"/>
          <Entry value="1" text="Full maps"/>
          <Entry value="2" text="Sub-maps"/>
        </EnumerationDomain>
      </IntVectorProperty>

      <IntVectorProperty name="Keypoints maps update step"
                         override="1"
                         command="SetMapsUpdateStep"
                         default_values="10"
                         panel_visibility="never">
      </IntVectorProperty>

      <IntVectorProperty name="Trajectory frequency"
                         override="1"
                         panel_visibility="never">
      </IntVectorProperty>

      <IntVectorProperty name="Output current keypoints"
                         override="1"
                         command="SetOutputCurrentKeypoints"
                         default_values="0"
                         panel_visibility="never">
        <BooleanDomain name="bool" />
      </IntVectorProperty>

      <IntVectorProperty name="Output keypoints in WORLD coordinates"
                         override="1"
                         command="SetOutputKeypointsInWorldCoordinates"
                         default_values="1"
                         panel_visibility="never">
        <BooleanDomain name="bool" />
      </IntVectorProperty>

    </SourceProxy>
  </ProxyGroup>
  <!-- End Mini Slam -->

</ServerManagerConfiguration>